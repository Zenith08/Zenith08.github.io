[{"name":"/Form","nodes":[{"id":"c799bc45-9188-8aca-c6d4-1e7ab9bbd3e3","type":"Group","parameters":{"sizeMode":"contentHeight"},"ports":[],"children":[{"id":"a03a234f-4da2-16e0-4255-f86389bb4029","type":"For Each","parameters":{"templateType":"dynamic","templateScript":"if(item.Type !== undefined)\n    component = './' + item.Type\nelse\n    component = \"./Text Input\""},"ports":[],"children":[]}]},{"id":"c0353b67-90d5-6d81-b17e-f98978d7e1bf","type":"Component Inputs","parameters":{},"ports":[],"children":[]},{"id":"4bcd9cfe-6d7d-33c6-5e11-9e2ed488b5bb","type":"Component Inputs","parameters":{},"ports":[],"children":[]},{"id":"2628d22e-3346-815f-cc8a-712df7cd272c","type":"JavaScriptFunction","parameters":{"functionScript":"// No controls, just exit with empty array\nif(Inputs.Controls === undefined) {\n    Component.Object.ControlItems = []\n    return\n}\n\n// If there is no object id provided, create a new object for form values\nlet formValues\nif(!Inputs.ObjectId || !Noodl.Object.exists(Inputs.ObjectId)) {\n    formValues = Component.Object.FormValues || Noodl.Object.create({})\n}\nelse {\n    formValues = Noodl.Objects[Inputs.ObjectId]\n}\n\nComponent.Object.FormValues = formValues\nOutputs.ObjectId = formValues.getId()\nconst errors = Component.Object.Errors = Inputs.Errors\n\n// Create the control items array (all form controls)\nComponent.Object.ControlItems = Inputs.Controls.map(c => {\n    // Errors should only be shown for a control if it has\n    // been edited, or if the form has been submitted (show all errors)\n    const haveValues = Component.Object.HaveValues||{}\n    const showAllErrors = Component.Object.ShowAllErrors\n    const error = (errors&&(haveValues[c.Property]||showAllErrors))?errors.find(e => e.Property === c.Property):undefined\n\n    const controlItem = {\n        id:Component.Object.id + '-' + c.Property,\n        Value:formValues[c.Property],\n        ObjectId:formValues.getId(),\n        Error:error?error.Error:\"\"\n    }\n\n    for(let key in c) { // Copy non function values to the new object\n        if(typeof c[key] !== \"function\" && typeof c[key] !== \"undefined\")\n            controlItem[key] = c[key]\n    }\n\n    return Noodl.Object.create(controlItem)\n})","scriptInputs":[{"id":"rzc4","label":"Controls"}],"intype-Controls":"array","in-Controls":"[\n    {\n        Type:\"Text Input\",\n        Label:\"Full Name\",\n        Property:\"Name\",\n    },\n    {\n        Type:\"Text Input\",\n        Label:\"Password\",\n        Property:\"Password\",\n        InputType:\"password\"\n    },    \n    {\n        Type:\"Checkbox\",\n        Label:\"Security\",\n        Text:\"Keep me signed in?\",\n        Property:\"KeepSignedIn\"\n    }\n]"},"ports":[{"name":"intype-Controls","displayName":"Type","editorName":"Controls | Type","plug":"input","type":{"name":"enum","enums":[{"value":"string","label":"String"},{"value":"boolean","label":"Boolean"},{"value":"number","label":"Number"},{"value":"object","label":"Object"},{"value":"date","label":"Date"},{"value":"array","label":"Array"},{"value":"color","label":"Color"}],"allowEditOnly":true},"default":"string","parent":"scriptInputs","parentItemId":"rzc4","index":4},{"name":"in-Controls","displayName":"Controls","plug":"input","type":"array","group":"Inputs","index":5},{"name":"in-ObjectId","displayName":"ObjectId","plug":"input","type":"*","group":"Inputs","index":6},{"name":"in-Errors","displayName":"Errors","plug":"input","type":"*","group":"Inputs","index":7},{"name":"out-ObjectId","displayName":"ObjectId","plug":"output","type":"*","group":"Outputs","index":8}],"children":[]},{"id":"e79f3037-087d-696d-2bc5-5dbe759a4d87","type":"net.noodl.ComponentObject","parameters":{"properties":"ControlItems"},"ports":[],"children":[]},{"id":"e2381eb2-1d69-2aeb-1a7d-3785dd874a0f","type":"JavaScriptFunction","parameters":{"functionScript":"Noodl.Events.on(Component.Object.id + '-Form.ValueChanged',(ev) => {\n    Component.Object.HaveValues[ev.Property] = true\n    \n    Outputs.Property = ev.Property\n    Outputs.Changed()\n})"},"ports":[{"name":"out-Changed","displayName":"Changed","plug":"output","type":"signal","group":"Outputs","index":4},{"name":"out-Property","displayName":"Property","plug":"output","type":"*","group":"Outputs","index":5}],"children":[]},{"id":"909401ba-855e-34b5-bd04-b80de6d3a24b","type":"Component Outputs","parameters":{},"ports":[],"children":[]},{"id":"f5bb531e-6eed-5092-9951-b3da0c3a0d97","type":"JavaScriptFunction","parameters":{"functionScript":"Component.Object.HaveValues = {}"},"ports":[],"children":[]},{"id":"3b74f96a-fad0-00c3-8d91-819cb569c89f","type":"JavaScriptFunction","parameters":{"functionScript":"const errors = Component.Object.Errors\nconst controlItems = Component.Object.ControlItems\n\n// To be valid there should be no errors for any\n// controls\nconst isValid = errors === undefined || errors.length === 0 || errors.every(e => !controlItems.find(c => c.Property === e.Property))\n\nif(isValid) {\n    Outputs.Validated()\n}\nelse {\n    // There were errors, since the user tried to submit\n    // show all errors\n    Component.Object.ShowAllErrors = true\n    controlItems.forEach(c => {\n        const error = errors.find(e => e.Property === c.Property)\n        c.Error = error?error.Error:\"\"\n    })\n    Outputs.HaveErrors()\n}"},"ports":[{"name":"out-Validated","displayName":"Validated","plug":"output","type":"signal","group":"Outputs","index":4},{"name":"out-HaveErrors","displayName":"HaveErrors","plug":"output","type":"signal","group":"Outputs","index":5}],"children":[]},{"id":"9403454a-fc42-1c98-c26b-6891cb3d8586","type":"Component Outputs","parameters":{},"ports":[],"children":[]}],"connections":[{"sourceId":"c0353b67-90d5-6d81-b17e-f98978d7e1bf","sourcePort":"Align Y","targetId":"c799bc45-9188-8aca-c6d4-1e7ab9bbd3e3","targetPort":"alignY"},{"sourceId":"c0353b67-90d5-6d81-b17e-f98978d7e1bf","sourcePort":"Align X","targetId":"c799bc45-9188-8aca-c6d4-1e7ab9bbd3e3","targetPort":"alignX"},{"sourceId":"c0353b67-90d5-6d81-b17e-f98978d7e1bf","sourcePort":"Margin Top","targetId":"c799bc45-9188-8aca-c6d4-1e7ab9bbd3e3","targetPort":"marginTop"},{"sourceId":"c0353b67-90d5-6d81-b17e-f98978d7e1bf","sourcePort":"Margin Bottom","targetId":"c799bc45-9188-8aca-c6d4-1e7ab9bbd3e3","targetPort":"marginBottom"},{"sourceId":"c0353b67-90d5-6d81-b17e-f98978d7e1bf","sourcePort":"Margin Left","targetId":"c799bc45-9188-8aca-c6d4-1e7ab9bbd3e3","targetPort":"marginLeft"},{"sourceId":"c0353b67-90d5-6d81-b17e-f98978d7e1bf","sourcePort":"Margin Right","targetId":"c799bc45-9188-8aca-c6d4-1e7ab9bbd3e3","targetPort":"marginRight"},{"sourceId":"c0353b67-90d5-6d81-b17e-f98978d7e1bf","sourcePort":"Position","targetId":"c799bc45-9188-8aca-c6d4-1e7ab9bbd3e3","targetPort":"position"},{"sourceId":"4bcd9cfe-6d7d-33c6-5e11-9e2ed488b5bb","sourcePort":"Controls","targetId":"2628d22e-3346-815f-cc8a-712df7cd272c","targetPort":"in-Controls"},{"sourceId":"4bcd9cfe-6d7d-33c6-5e11-9e2ed488b5bb","sourcePort":"Object Id","targetId":"2628d22e-3346-815f-cc8a-712df7cd272c","targetPort":"in-ObjectId"},{"sourceId":"4bcd9cfe-6d7d-33c6-5e11-9e2ed488b5bb","sourcePort":"Errors","targetId":"2628d22e-3346-815f-cc8a-712df7cd272c","targetPort":"in-Errors"},{"sourceId":"e2381eb2-1d69-2aeb-1a7d-3785dd874a0f","sourcePort":"out-Changed","targetId":"909401ba-855e-34b5-bd04-b80de6d3a24b","targetPort":"Value Changed"},{"sourceId":"e2381eb2-1d69-2aeb-1a7d-3785dd874a0f","sourcePort":"out-Property","targetId":"909401ba-855e-34b5-bd04-b80de6d3a24b","targetPort":"Property"},{"sourceId":"c799bc45-9188-8aca-c6d4-1e7ab9bbd3e3","sourcePort":"didMount","targetId":"f5bb531e-6eed-5092-9951-b3da0c3a0d97","targetPort":"run"},{"sourceId":"c0353b67-90d5-6d81-b17e-f98978d7e1bf","sourcePort":"Width","targetId":"c799bc45-9188-8aca-c6d4-1e7ab9bbd3e3","targetPort":"width"},{"sourceId":"4bcd9cfe-6d7d-33c6-5e11-9e2ed488b5bb","sourcePort":"Submit","targetId":"3b74f96a-fad0-00c3-8d91-819cb569c89f","targetPort":"run"},{"sourceId":"3b74f96a-fad0-00c3-8d91-819cb569c89f","sourcePort":"out-Validated","targetId":"9403454a-fc42-1c98-c26b-6891cb3d8586","targetPort":"Valid Submit"},{"sourceId":"3b74f96a-fad0-00c3-8d91-819cb569c89f","sourcePort":"out-HaveErrors","targetId":"9403454a-fc42-1c98-c26b-6891cb3d8586","targetPort":"Have Errors"},{"sourceId":"e79f3037-087d-696d-2bc5-5dbe759a4d87","sourcePort":"value-ControlItems","targetId":"a03a234f-4da2-16e0-4255-f86389bb4029","targetPort":"items"},{"sourceId":"2628d22e-3346-815f-cc8a-712df7cd272c","sourcePort":"out-ObjectId","targetId":"9403454a-fc42-1c98-c26b-6891cb3d8586","targetPort":"Object Id"}],"ports":[{"name":"Value Changed","type":"signal","group":"Events","plug":"output","index":0},{"name":"Valid Submit","type":"signal","group":"Events","plug":"output","index":0},{"name":"Align Y","type":{"name":"enum","enums":[{"label":"Top","value":"top"},{"label":"Center","value":"center"},{"label":"Bottom","value":"bottom"}],"alignComp":"vertical"},"group":"Alignment","plug":"input","index":0},{"name":"Controls","type":"array","default":"[\n    {\n        Type:\"Text Input\",\n        Label:\"Full Name\",\n        Property:\"Name\",\n    },\n    {\n        Type:\"Text Input\",\n        Label:\"Password\",\n        Property:\"Password\",\n        InputType:\"password\"\n    },    \n    {\n        Type:\"Checkbox\",\n        Label:\"Security\",\n        Text:\"Keep me signed in?\",\n        Property:\"KeepSignedIn\"\n    }\n]","group":"General","plug":"input","index":0},{"name":"Property","type":"*","group":"General","plug":"output","index":1},{"name":"Have Errors","type":"signal","group":"Events","plug":"output","index":1},{"name":"Align X","type":{"name":"enum","enums":[{"label":"Left","value":"left"},{"label":"Center","value":"center"},{"label":"Right","value":"right"}],"alignComp":"horizontal"},"group":"Alignment","plug":"input","index":1},{"name":"Object Id","type":"*","group":"General","plug":"input","index":1},{"name":"Object Id","type":"*","group":"General","plug":"output","index":2},{"name":"Margin Top","type":{"name":"number","units":["px","%"],"defaultUnit":"px","marginPaddingComp":"margin-top"},"group":"Margins","plug":"input","index":2},{"name":"Errors","type":"*","group":"General","plug":"input","index":2},{"name":"Margin Bottom","type":{"name":"number","units":["px","%"],"defaultUnit":"px","marginPaddingComp":"margin-bottom"},"group":"Margins","plug":"input","index":3},{"name":"Submit","type":{"name":"signal","allowConnectionsOnly":true},"group":"Actions","plug":"input","index":3},{"name":"Margin Left","type":{"name":"number","units":["px","%"],"defaultUnit":"px","marginPaddingComp":"margin-left"},"group":"Margins","plug":"input","index":4},{"name":"Margin Right","type":{"name":"number","units":["px","%"],"defaultUnit":"px","marginPaddingComp":"margin-right"},"group":"Margins","plug":"input","index":5},{"name":"Position","type":{"name":"enum","enums":[{"label":"In Layout","value":"relative"},{"label":"Absolute","value":"absolute"},{"label":"Sticky","value":"sticky"},{"label":"Fixed","value":"fixed"}]},"default":"relative","group":"Layout","plug":"input","index":7},{"name":"Width","type":{"name":"dimension","units":["%","px","vw","vh"],"defaultUnit":"%"},"default":100,"group":"Dimensions","plug":"input","index":8}],"roots":["c799bc45-9188-8aca-c6d4-1e7ab9bbd3e3"]}]